<Window x:Class="UrbanChaosMapEditor.Views.LightPropertiesDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Light Map Properties"
        SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterOwner"
        MinWidth="540" MinHeight="520"
        ResizeMode="NoResize"
        Foreground="White">

    <Window.Resources>
        <!-- Make group headers clearly separated -->
        <Style x:Key="WhiteTickCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <StackPanel Orientation="Horizontal">
                            <Border Width="16" Height="16"
                  Background="Black"
                  BorderBrush="White"
                  BorderThickness="1">
                                <Path x:Name="CheckMark"
                  Data="M0,4 L2,6 6,0"
                  Stroke="White"
                  StrokeThickness="2"
                  Visibility="Collapsed"
                  SnapsToDevicePixels="True"/>
                            </Border>
                            <ContentPresenter Margin="6,0,0,0"
                            VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="CheckMark" Property="Opacity" Value="0.6"/>
                                <Setter Property="Foreground" Value="#6FFFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="GroupBox">
            <Setter Property="Margin" Value="0,8,0,8"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderBrush" Value="#555"/>
            <Setter Property="BorderThickness" Value="1"/>
            <!-- Header bar with bold white text -->
            <Setter Property="HeaderTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Border Background="#2A2A2A"
                            BorderBrush="#555"
                            BorderThickness="0,0,0,1"
                            Padding="8,4"
                            Margin="-6,-6,-6,6">
                            <TextBlock Text="{Binding}" Foreground="White" FontWeight="Bold"/>
                        </Border>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Ensure all the usual text-bearing controls render white -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#1E1E1E"/>
            <Setter Property="BorderBrush" Value="#555"/>
        </Style>
    </Window.Resources>
    
    <DockPanel Margin="12">

        <!-- Buttons -->
        <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button x:Name="BtnOK"     Width="90" Height="28" Margin="0,0,8,0" IsDefault="True"  Content="OK"     Click="OK_Click"/>
            <Button x:Name="BtnCancel" Width="90" Height="28"                 IsCancel="True" Content="Cancel"/>
        </StackPanel>

        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Orientation="Vertical" >

                <!-- Night Flags -->
                <GroupBox Header="Night Flags" Margin="0,6,0,10">
                    <StackPanel Orientation="Horizontal" Margin="8,4,8,6">
                        <CheckBox Style="{StaticResource WhiteTickCheckBox}"
          Content="Lamps On"
          IsChecked="{Binding FlagLampsOn, Mode=TwoWay}"/>

                        <CheckBox Style="{StaticResource WhiteTickCheckBox}"
          Content="Darken Walls"
          IsChecked="{Binding FlagDarkenWalls, Mode=TwoWay}"/>

                        <CheckBox Style="{StaticResource WhiteTickCheckBox}"
          Content="Day"
          IsChecked="{Binding FlagDay, Mode=TwoWay}"/>
                    </StackPanel>

                </GroupBox>
                <TextBlock Margin="0,6,0,0"
           Foreground="#99FFFFFF"
           FontStyle="Italic"
           FontSize="11"
           Text="{Binding FlagsDebug}"/>

                <!-- D3D + Specular -->
                <GroupBox Header="D3D and Specular Color" Margin="0,8,0,8" Padding="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- D3D ? -->
                            <RowDefinition Height="Auto"/>
                            <!-- Spec ? -->
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                            <!-- D3D RGB -->
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                            <!-- Spec RGB -->
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                            <!-- previews -->
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="70"/>
                            <!-- label -->
                            <ColumnDefinition Width="*"/>
                            <!-- slider -->
                            <ColumnDefinition Width="40"/>
                            <!-- value -->
                        </Grid.ColumnDefinitions>

                        <!-- D3D Alpha -->
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="D3D Alpha" VerticalAlignment="Center"/>
                        <Slider x:Name="SldD3DAlpha" Grid.Row="0" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="0" Grid.Column="2"
                   Text="{Binding ElementName=SldD3DAlpha, Path=Value, StringFormat=F0}" />

                        <!-- Specular Alpha -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Specular Alpha" VerticalAlignment="Center"/>
                        <Slider x:Name="SldSpecAlpha" Grid.Row="1" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="1" Grid.Column="2"
                   Text="{Binding ElementName=SldSpecAlpha, Path=Value, StringFormat=F0}" />

                        <!-- D3D RGB -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="R" VerticalAlignment="Center"/>
                        <Slider x:Name="SldD3DR" Grid.Row="3" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="3" Grid.Column="2"
                   Text="{Binding ElementName=SldD3DR, Path=Value, StringFormat=F0}" />

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="G" VerticalAlignment="Center"/>
                        <Slider x:Name="SldD3DG" Grid.Row="4" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="4" Grid.Column="2"
                   Text="{Binding ElementName=SldD3DG, Path=Value, StringFormat=F0}" />

                        <TextBlock Grid.Row="5" Grid.Column="0" Text="B" VerticalAlignment="Center"/>
                        <Slider x:Name="SldD3DB" Grid.Row="5" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="5" Grid.Column="2"
                   Text="{Binding ElementName=SldD3DB, Path=Value, StringFormat=F0}" />

                        <!-- Specular RGB -->
                        <TextBlock Grid.Row="7" Grid.Column="0" Text="R" VerticalAlignment="Center"/>
                        <Slider x:Name="SldSpecR" Grid.Row="7" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="7" Grid.Column="2"
                   Text="{Binding ElementName=SldSpecR, Path=Value, StringFormat=F0}" />

                        <TextBlock Grid.Row="8" Grid.Column="0" Text="G" VerticalAlignment="Center"/>
                        <Slider x:Name="SldSpecG" Grid.Row="8" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="8" Grid.Column="2"
                   Text="{Binding ElementName=SldSpecG, Path=Value, StringFormat=F0}" />

                        <TextBlock Grid.Row="9" Grid.Column="0" Text="B" VerticalAlignment="Center"/>
                        <Slider x:Name="SldSpecB" Grid.Row="9" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnD3DChanged"/>
                        <TextBlock Grid.Row="9" Grid.Column="2"
                   Text="{Binding ElementName=SldSpecB, Path=Value, StringFormat=F0}" />

                        <!-- Previews -->
                        <StackPanel Grid.Row="11" Grid.ColumnSpan="3" Orientation="Vertical" Margin="0,6,0,0">
                            <Rectangle x:Name="RectD3DPreview" Height="16" RadiusX="2" RadiusY="2" />
                            <Rectangle x:Name="RectSpecPreview" Height="16" RadiusX="2" RadiusY="2" Margin="0,6,0,0"/>
                        </StackPanel>
                    </Grid>
                </GroupBox>

                <!-- Night Ambient -->
                <GroupBox Header="Night Ambient (RGB)" Margin="0,8,0,8" Padding="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="40"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="R" VerticalAlignment="Center"/>
                        <Slider x:Name="SldAmbR" Grid.Row="0" Grid.Column="1" Minimum="-127" Maximum="127"
                ValueChanged="OnAmbientChanged"/>
                        <TextBlock Grid.Row="0" Grid.Column="2"
                   Text="{Binding ElementName=SldAmbR, Path=Value, StringFormat=F0}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="G" VerticalAlignment="Center"/>
                        <Slider x:Name="SldAmbG" Grid.Row="1" Grid.Column="1" Minimum="-127" Maximum="127"
                ValueChanged="OnAmbientChanged"/>
                        <TextBlock Grid.Row="1" Grid.Column="2"
                   Text="{Binding ElementName=SldAmbG, Path=Value, StringFormat=F0}"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="B" VerticalAlignment="Center"/>
                        <Slider x:Name="SldAmbB" Grid.Row="2" Grid.Column="1" Minimum="-127" Maximum="127"
                ValueChanged="OnAmbientChanged"/>
                        <TextBlock Grid.Row="2" Grid.Column="2"
                   Text="{Binding ElementName=SldAmbB, Path=Value, StringFormat=F0}"/>

                        <Rectangle x:Name="RectAmbPreview" Grid.Row="4" Grid.ColumnSpan="3"
                   Height="16" RadiusX="2" RadiusY="2" />
                    </Grid>
                </GroupBox>

                <!-- Light Emitting Prim Color + Radius -->
                <GroupBox Header="Light Emitting Prim Color" Margin="0,8,0,8" Padding="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                            <!-- Radius -->
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                            <!-- Preview -->
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="40"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="R" VerticalAlignment="Center"/>
                        <Slider x:Name="SldLampR" Grid.Row="0" Grid.Column="1" Minimum="-127" Maximum="127"
                ValueChanged="OnLampChanged"/>
                        <TextBlock Grid.Row="0" Grid.Column="2"
                   Text="{Binding ElementName=SldLampR, Path=Value, StringFormat=F0}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="G" VerticalAlignment="Center"/>
                        <Slider x:Name="SldLampG" Grid.Row="1" Grid.Column="1" Minimum="-127" Maximum="127"
                ValueChanged="OnLampChanged"/>
                        <TextBlock Grid.Row="1" Grid.Column="2"
                   Text="{Binding ElementName=SldLampG, Path=Value, StringFormat=F0}"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="B" VerticalAlignment="Center"/>
                        <Slider x:Name="SldLampB" Grid.Row="2" Grid.Column="1" Minimum="-127" Maximum="127"
                ValueChanged="OnLampChanged"/>
                        <TextBlock Grid.Row="2" Grid.Column="2"
                   Text="{Binding ElementName=SldLampB, Path=Value, StringFormat=F0}"/>

                        <!-- Radius -->
                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Radius" VerticalAlignment="Center"/>
                        <Slider x:Name="SldRadius" Grid.Row="4" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnLampChanged"/>
                        <TextBlock Grid.Row="4" Grid.Column="2"
                   Text="{Binding ElementName=SldRadius, Path=Value, StringFormat=F0}"/>

                        <Rectangle x:Name="RectLampPreview" Grid.Row="6" Grid.ColumnSpan="3" Height="16"
                   RadiusX="2" RadiusY="2"/>
                    </Grid>
                </GroupBox>

                <GroupBox Header="Night Sky Colour" Margin="0,8,0,8" Padding="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="40"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="R" VerticalAlignment="Center"/>
                        <Slider x:Name="SldSkyR" Grid.Row="0" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnSkyChanged"/>
                        <TextBlock Grid.Row="0" Grid.Column="2"
                   Text="{Binding ElementName=SldSkyR, Path=Value, StringFormat=F0}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="G" VerticalAlignment="Center"/>
                        <Slider x:Name="SldSkyG" Grid.Row="1" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnSkyChanged"/>
                        <TextBlock Grid.Row="1" Grid.Column="2"
                   Text="{Binding ElementName=SldSkyG, Path=Value, StringFormat=F0}"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="B" VerticalAlignment="Center"/>
                        <Slider x:Name="SldSkyB" Grid.Row="2" Grid.Column="1" Minimum="0" Maximum="255"
                ValueChanged="OnSkyChanged"/>
                        <TextBlock Grid.Row="2" Grid.Column="2"
                   Text="{Binding ElementName=SldSkyB, Path=Value, StringFormat=F0}"/>

                        <Rectangle x:Name="RectSkyPreview" Grid.Row="4" Grid.ColumnSpan="3" Height="16"
                   RadiusX="2" RadiusY="2"/>
                    </Grid>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>
    </DockPanel>
</Window>
